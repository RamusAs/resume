{"version":3,"file":"resumed.cjs.development.js","sources":["../src/cli.ts","../src/init.ts","../src/load-themes.ts","../src/render.ts","../src/validate.ts"],"sourcesContent":["#!/usr/bin/env node\nimport { promises as fs } from 'fs'\nimport { red, yellow } from 'colorette'\nimport sade from 'sade'\nimport { init, loadThemes, render, validate } from '.'\n\nconst pkg = require('../package.json')\n\ntype RenderOptions = {\n  output: string\n  theme?: string\n}\n\nexport const cli = sade(pkg.name).version(pkg.version)\n\ncli\n  .command('render [filename]', 'Render resume', {\n    alias: 'export',\n    default: true,\n  })\n  .option('-o, --output', 'Output filename', 'resume.html')\n  .option('-t, --theme', 'Theme to use, if more than one is installed')\n  .action(\n    async (\n      filename: string = 'resume.json',\n      { output, theme }: RenderOptions,\n    ) => {\n      const resume = JSON.parse(await fs.readFile(filename, 'utf-8'))\n      const [loadedTheme, ...otherLoadedThemes] = await loadThemes(theme)\n\n      if (loadedTheme == null) {\n        console.log(\n          `Could not find a JSON Resume theme to render. Try installing one (e.g. ${yellow(\n            'npm i jsonresume-theme-even',\n          )}) and run the command again. 😉`,\n        )\n\n        process.exitCode = 1\n        return\n      }\n\n      if (otherLoadedThemes.length > 0) {\n        console.log(\n          `Found ${\n            otherLoadedThemes.length + 1\n          } JSON Resume themes installed, defaulting to ${yellow(\n            loadedTheme.name,\n          )}. Pass the ${yellow(\n            '--theme',\n          )} option if you would like to use another one.`,\n        )\n      }\n\n      const rendered = await render(resume, loadedTheme.module)\n      await fs.writeFile(output, rendered)\n\n      console.log(\n        `You can find your rendered resume at ${yellow(output)}. Nice work! 🚀`,\n      )\n    },\n  )\n\ncli\n  .command('init [filename]', 'Create sample resume', { alias: 'create' })\n  .action(async (filename: string = 'resume.json') => {\n    await init(filename)\n    console.log(\n      `Done! Start editing ${yellow(filename)} now, and run the ${yellow(\n        'render',\n      )} command when you are ready. 👍`,\n    )\n  })\n\ncli\n  .command('validate [filename]', 'Validate resume')\n  .action(async (filename: string = 'resume.json') => {\n    try {\n      await validate(filename)\n      console.log(`Your ${yellow(filename)} looks amazing! ✨`)\n    } catch (err) {\n      if (!Array.isArray(err)) {\n        throw err\n      }\n\n      console.log(\n        `Uh-oh! The following errors were found in ${yellow(filename)}:\\n`,\n      )\n      err.forEach((err: { message: string; path: string }) =>\n        console.log(` ${red(`❌ ${err.message}`)} at ${yellow(err.path)}.`),\n      )\n\n      process.exitCode = 1\n    }\n  })\n","import { promises as fs } from 'fs'\n\nexport const init = (filename: string) => {\n  const resume = require('resume-schema/sample.resume.json')\n  return fs.writeFile(filename, JSON.stringify(resume, undefined, 2))\n}\n","// Based on https://github.com/prettier/prettier/blob/master/src/common/load-plugins.js\nimport { promises as fs } from 'fs'\nimport path from 'path'\nimport escalade from 'escalade'\nimport globby from 'globby'\nimport uniqBy from 'lodash.uniqby'\n\nconst isDir = async (dir: string) => {\n  try {\n    return (await fs.stat(dir)).isDirectory()\n  } catch {\n    return false\n  }\n}\n\nconst findThemesInNodeModules = async (theme = '*', nodeModulesDir: string) =>\n  (\n    await globby(\n      [\n        `jsonresume-theme-${theme}/package.json`,\n        `@*/jsonresume-theme-${theme}/package.json`,\n        `@jsonresume/theme-${theme}/package.json`,\n      ],\n      { cwd: nodeModulesDir, expandDirectories: false },\n    )\n  ).map(path.dirname)\n\nexport const loadThemes = async (theme?: string) => {\n  const themeSearchDir = await escalade(\n    process.cwd(),\n    (_dir, names) => names.includes('node_modules') && '.',\n  )\n\n  if (!themeSearchDir) {\n    throw new Error('node_modules directory not found')\n  }\n\n  const nodeModulesDir = path.resolve(themeSearchDir, 'node_modules')\n\n  // In some fringe cases (e.g. files \"mounted\" as virtual directories),\n  // the isDir(themeSearchDir) check might be false even though node_modules\n  // actually exists.\n  if (!(await isDir(nodeModulesDir)) && !(await isDir(themeSearchDir))) {\n    throw new Error(`${themeSearchDir} does not exist or is not a directory`)\n  }\n\n  const themesInfo = (await findThemesInNodeModules(theme, nodeModulesDir)).map(\n    name => ({\n      name: name.split('-').pop()!,\n      path: require.resolve(name, { paths: [themeSearchDir] }),\n    }),\n  )\n\n  return uniqBy(themesInfo, 'path').map(info => ({\n    ...info,\n    module: require(info.path),\n  }))\n}\n","type Theme<T> = {\n  render: (resume: object) => T | Promise<T>\n}\n\nexport const render = (resume: object, theme: Theme<string>) =>\n  theme.render(resume)\n","import { promises as fs } from 'fs'\nimport schema from 'resume-schema'\nimport { promisify } from 'util'\n\nconst schemaValidate = promisify(schema.validate)\n\nexport const validate = async (filename: string) => {\n  const resume = await fs.readFile(filename, 'utf-8')\n  return schemaValidate(JSON.parse(resume))\n}\n"],"names":["pkg","require","cli","sade","name","version","command","alias","default","option","action","filename","output","theme","resume","JSON","parse","fs","readFile","loadedTheme","otherLoadedThemes","loadThemes","console","log","yellow","process","exitCode","length","rendered","render","module","writeFile","init","validate","err","Array","isArray","forEach","red","message","path","stringify","undefined","isDir","dir","stat","isDirectory","findThemesInNodeModules","nodeModulesDir","globby","cwd","expandDirectories","map","dirname","themeSearchDir","escalade","_dir","names","includes","Error","resolve","themesInfo","split","pop","paths","uniqBy","info","schemaValidate","promisify","schema"],"mappings":"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"}